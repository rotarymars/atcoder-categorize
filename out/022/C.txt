
●

辺に重み（長さ）のある無向グラフが与えられ
る
– 頂点数N ≦ 300, 辺数 M ≦ N(N-1)/2

●

頂点1から開始して、頂点1に戻ってくる、同
じ辺を二度通らない経路があるか求めよ。ある
ならばその中で最短なものの長さを求めよ。

●

入出力1

●

入出力1：正解の経路

●

見た目は最短経路問題に似ている
– 今求めたいのは最短「閉路」なのでそのまま

Dijkstraなどを使うことはできない
●

最短閉路も部分的には最短経路に似た性質を
持っている

●

閉路の例

●

閉路の例

●

閉路の例

●

頂点1に隣接する頂点はちょうど2つ含まれる

●

頂点1に隣接する頂点はちょうど2つ含まれる
– 頂点1に隣接する頂点はO(N)個
– どの2つを選ぶかはO(N^2)通り

●

頂点1に隣接する辺を除いて考えてみる

Before

●

頂点1に隣接する辺を除いて考えてみる

After

●

頂点1に隣接する辺を除いて考えてみる

●

閉路が経路になった
– 扱いやすい！

●

頂点1に隣接する頂点のうち、どの2つを経路
に含めるか決めれば、あとは最短経路問題にな
る
– 頂点1に隣接する辺を除いたグラフでの最短経路問

題

●

頂点1に隣接する頂点のうちどの2つを閉路に
含めるか全通り試す
– 頂点X,Yを選んだとする

●

頂点1に隣接する辺を除いたグラフでXとYの最
短経路の長さを求める
– Sとする

●

1とX,1とYを結ぶ辺の長さの和とSを足しあわ
せたものがX,Yを含む閉路の中で最短の閉路

●

頂点1に隣接する頂点のうちどの2つを閉路に
含めるか全通り試す
O(N^2)
– 頂点X,Yを選んだとする

●

頂点1に隣接する辺を除いたグラフでXとYの最
短経路の長さを求める
– Sとする

●

O(？)

1とX,1とYを結ぶ辺の長さの和とSを足しあわ
せたものがX,Yを含む閉路の中で最短の閉路

●

「頂点1に隣接した辺を除いたグラフ」という
共通のグラフの様々な点対に対して最短経路を
求めなければならない
– 毎回計算するとDijkstraでもO(N^2)かかる
– それをO(N^2)回繰り返すので合計でO(N^4)

●

「頂点1に隣接した辺を除いたグラフ」という
共通のグラフの様々な点対に対して最短経路を
求めなければならない
– 毎回計算するとDijkstraでもO(N^2)かかる
– それをO(N^2)回繰り返すので合計でO(N^4)

●

あらかじめ全点対の最短経路を求めておけば良
い
– Warshall-Floydを使えばO(N^3)を1回ですむ

●

●

●

「頂点1に隣接する辺を除いたグラフ」の全点
対の最短経路を前計算しておく
頂点1に隣接する頂点のうちどの2つを閉路に
含めるか全通り試す
前計算した最短経路の結果と合わせて最短閉路
の長さを求める

●

「頂点1に隣接する辺を除いたグラフ」の全点
対の最短経路を前計算しておく

O(N^3)

●

頂点1に隣接する頂点のうちどの2つを閉路に
含めるか全通り試す

O(N^2)

●

前計算した最短経路の結果と合わせて最短閉路
の長さを求める

合計O(N^3)

●
●

最短経路木を使った解法があります
「最短経路木に含まれる辺いくつか」と「最短
経路木に含まれない辺をちょうど1つ」使うこ
とで最短閉路が存在するならば必ず作ることが
できます
– 証明などが難しいので詳しい内容は割愛

●

●

ボトルネックは最短経路木の構築でO(N^2)も
しくはO(ElogN) ※Eは辺の数
今回は制約がN≦300なのでこれを使わなくて
も良い

ABC022解説

