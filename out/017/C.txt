
問題概要
• 連続した整数を覆う区間がいくつか与えられます。
• 1 から M までのすべてが登場しないように区間の集合を選びます。
• 選んだ区間の値の合計を最大化してください。
• 1 ≦ 𝑁(区間数) ≦ 100,000
• 1 ≦ 𝑀 ≦ 100,000

部分点解法 1 (30点)
• すべての区間の集合を考えます。
• 各数字について、その数字を覆う区間が集合にあるかどうかを判定
します。
• どの区間にも含まれなかった数字があれば成立、そうでなければ不
成立です。
• 全体の計算量はO(𝑁 ∗ 𝑀 ∗ 2𝑁 ) などになります。

部分点解法 2 (30+70点)
• すべての区間の組み合わせは指数オーダー存在するので、他の方
針を考える必要があります。
• 現在選んでいる集合がどの数字を覆っているかを情報として保存す
る方針では、保存すべき状態数が2𝑀 個あり、これも大きいです。

部分点解法 2 (30+70点)
• 条件を満たす集合を考えると、条件を満たす集合では、「少なくとも 1
つの数字を覆っていない」という条件が成り立ちます。
• そこで、覆っていない数字を固定して考えてみます。
• 覆っていない数字を 𝑋 としたとき、各区間について
- 区間が𝑋 を覆っている場合、その区間は採用できない。
- 区間が𝑋 を覆っていない場合、その区間は採用しても問題ない。
• 採用可能な区間すべてを採用しても 𝑋 は覆われず、かつ採用自体
には得点のデメリットはないので、すべてを採用するとその𝑋 につい
ては最適解が求まります。

部分点解法 2 (30+70点)
• 先ほどの計算をすべての 𝑋 について試すことで最適解を計算するこ
とができます。
• 計算量は、各 𝑋 (全部で 𝑀 通りある) について O(𝑁) で判定できるの
で、全体で O(𝑁𝑀) となります。

満点解法 (30+70+1点)
• 先の計算で、「覆っていない区間の合計得点を求める」のではなく、
「全体の合計得点から覆っている区間の合計得点を引く」という方針
で考えることにします。
• 覆っている区間の合計得点は、以下のことを実行できる配列,データ
構造があれば実現できます。
- ある連続した領域に同じ値を足す。
- 特定の 1 要素の値を求める。

満点解法 (30+70+1点)
• そのようなデータ構造は、segment-tree を用いることで実現すること
ができますが、今回は値の計算が最後にまとめて来ることから、競
技プログラミング界隈では「いもす法」として知られている方法を用い
ることができます。
• 具体的には、配列 array の array[l] から array[r] までに v ずつ足した
い場合には、1 つずつ足す代わりに array[l] だけに v を足し、
array[r+1] に –v を足すようにします。
• 最後に array[i+1] = array[i] + array[i+1] を i = 1,2,…,M-1 について実
行します。

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

0

0

0

0

0

0

0

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

0

0

-30

0

0

0

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

40

0

-70

0

0

0

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

40

25

-70

0

0

-25

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

40

25

-70

0

10

-35

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

40

25

-70

0

10

-35

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

70

25

-70

0

10

-35

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

70

95

-70

0

10

-35

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

70

95

25

0

10

-35

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

70

95

25

25

10

-35

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

70

95

25

25

35

-35

満点解法 (30+70+1点)
•例
30
40
25
10
• Array
0

30

70

95

25

25

35

0

満点解法 (30+70+1点)
•例
• この中の最小値(25) を全体 (105) から引いた 80 が答えとなります。

• Array
0

30

70

95

25

25

35

0

