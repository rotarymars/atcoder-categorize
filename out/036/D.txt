この問題で与えられているような構造を木という．また，島に対応するも
のを頂点，橋に対応するものを辺という．
頂点 1 を根と呼ぶことにする．頂点 x を親とする部分木とは，頂点 1 か
ら頂点 y に行くときに必ず頂点 x を通らなければならないような頂点 y の
集合のことである．
次のような値を考える．

• f (x): 頂点 x を親とする部分木に含まれる頂点をすべて白または黒で
塗り，両端が黒で塗られた辺が存在しないようにする方法は何通りか？

• g(x): 頂点 x を親とする部分木に含まれる頂点をすべて白または黒で
塗り，両端が黒で塗られた辺が存在しないようにする方法は何通りか？
ただし，頂点 x は必ず白で塗らなければならない．
頂点 x を親とする部分木のうち，x と隣り合っている頂点を x の子とい
う．x の子が y1 , . . . , yk であるとき，次の式が成り立つ．

• f (x) = g(x) + g(y1 ) ∗ g(y2 ) ∗ · · · ∗ g(yk )
• g(x) = f (y1 ) ∗ f (y2 ) ∗ · · · ∗ f (yk )
上の式を用いて，f, g の値を根から遠い頂点から順に求めていけばよい．
このように，木の上で漸化式を使って解くアルゴリズムは tree DP と呼ば
れる．この問題は tree DP の簡単な場合である．

2


