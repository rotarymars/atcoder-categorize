まず、(ai , bi ) の組を bi について昇順にソートします。ソートした順に、以下を行います。

• 既にその要望を満たしている場合、すなわち、既に 1 本以上橋を取り除いていて、直前に取り除いた橋
によってその要望が満たされている場合、何もしない。ここで、直前に取り除いた橋によってその要
望が満たされている場合とは、西から x 番目の橋を直前に取り除いたとすると、ai ≤ x であることで
ある。

• まだその要望を満たしていない場合、西から bi − 1 番目の橋、すなわち西から bi − 1 番目の島と bi 番
目の島を接続する橋を取り除く。
このとき、最適となります。なぜなら、後者の場合について、西から ai 番目, ai + 1 番目, ..., bi − 1 番目の
橋のうち 1 つ以上取り除かなければなりませんが、bi − 1 番目より手前の橋 (西から x 番目の橋とする) を取
り除いたとき、後に残る部分問題 (西から x + 1 番目以降の島と橋のみについての問題) を考えれば必ず損す
るからです。したがって、ソートがボトルネックとなり、O(nlogn) で解けました。
余談: 実は O(n) でも解くことができます。興味があれば考えてみてください。

4


