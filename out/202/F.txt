
		公式
		
			
				F - Integer Convex Hull 解説
			
			by KoD
			
		
		
		
		
			点の座標が整数であるので、任意の \(3\) 点からなる三角形の面積は \(2\) 倍すると整数になります。凸包の面積は、ある点を固定し、凸包をその点を含む三角形に分解することによって計算することができます。「ある固定された点を必ず含むような凸多角形」を、三角形を一つずつ貼り合わせていくかのように構成することはできないでしょうか？

既知のアルゴリズムを適用できないか考えてみましょう。凸包を構成するアルゴリズムとしては、Monotone Chain と呼ばれるものが有名です。概略は以下のようになります :


点を \(x\) 座標の小さい順にソート する ( \(x\) 座標が同じものは \(y\) 座標の小さい順に並べる) 。ソート後において先頭にある点と末尾にある点は必ず凸包に含まれる。
点を順番に見ていき、前述の二点を結ぶように、上側凸包と下側凸包を構築する。


上の方法と同様に、まずは与えられた点をソートします。次に、凸多角形に含まれる左下の点 ( \(x\) 座標が最も小さいものの中で、\(y\) 座標が最も小さいもの) を固定し、\(O(N)\) 通り試すことにします。

固定された点を \(P_s\) とおきます。 \(P_s\) を一点にもつ三角形を貼り合わせていくようにして、上側凸包と下側凸包を構成しましょう。以下の動的計画法を考えます :


\(\mathrm{upper}_{i, j, k}\)：頂点集合 \(S\) であって、その凸包が以下の条件を満たすものの総数。


\(P_s\) から時計回りに点を見ていったとき、最後の \(2\) 点がそれぞれ \(P_i, P_j\) である。
全ての点が線分 \(P_sP_j\) の上側にある。
面積を \(2\) 倍した値を \(2\) で割ったあまりが \(k\) である。

\(\mathrm{lower}_{i, j, k}\)：頂点集合 \(S\) であって、その凸包が以下の条件を満たすものの総数。


\(P_s\) から反時計回りに点を見ていったとき、最後の \(2\) 点がそれぞれ \(P_i, P_j\) である。
全ての点が線分 \(P_s P_j\) の下側にある。
面積を \(2\) 倍した値を \(2\) で割ったあまりが \(k\) である。



各 \(j, k\) について \(\displaystyle \left( \sum_{i} \mathrm{upper}_{i, j, k} \right) \times \left( \sum_{i} \mathrm{lower}_{i, j, k} \right)\) を足し合わせたものが答えとなります。

前計算として、各三角形についてその面積と内部に含まれる点の個数を調べておく必要があることに注意してください。全体の計算量は \(O(N^4)\) となります。

実装例 (C++) :



別解

凸包を構成するもう一つのアルゴリズムとして、Graham Scan と呼ばれるものがあります。これは、左下の点を中心に偏角ソートを行い、点を順番に見て凸包を構成するというものです。これを応用した動的計画法を行うことで、凸包を上下に分割することなく数え上げることができます。

実装例 (Rust) :



類題

日本情報オリンピック 春合宿 2008 「最古の遺跡 2」

		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
