a1 , a2 , ..., aN の最大公約数を D とすると、a1 , a2 , ..., aN は D で割り切れるので M = a1 + a2 + ... + aN
も D で割り切れます。従って、D は M の約数になります。
また、D が M の約数のとき、a1 , a2 , ..., aN ≥ D なので M ≥ N × D です。
実は D が M の約数であって M ≥ N × D を満たすとき、最大公約数が D 以上となるように a1 , a2 , ..., aN
が構成できます。具体的には、a1 = a2 = ... = aN −1 = D, aN = M − (N − 1) × D とします。このとき、

aN は正整数かつ D の倍数なので各要素の最大公約数は D 以上*1 となります。
したがって、M の約数かつ M
N 以下の整数のなかで最大のものが答えとなります。約数は (約数のペアの片

√

√

方が平方根以下であることを利用して)、O( M ) で求められることが知られているため、この問題は O( M )
で解くことができます。

*1 N = 1 のとき最大公約数は M となり D より大きくなることがあります

5


