次の手順で、

∑

aij が偶数なら全て偶数にでき、奇数なら 1 マスを除いて全て偶数にできます。

まず、一筆書きの経路を作ります。例えば、

(1, 1), (1, 2), ..., (1, W ), (2, W ), (2, W − 1), ..., (2, 1), (3, 1), (3, 2), ...
です。この経路が通る i 番目のマスを (Yi , Xi ) とします。次に、i = 1, 2, ..., H × W − 1 の順に aYi Xi が奇
数ならマス (Yi , Xi ) からマス (Yi+1 , Xi+1 ) に箱を 1 個移動させる操作をします。この操作により、aYi Xi に

−1、aYi+1 Xi+1 に 1 が加算され、aYi Xi が偶数になります。一連の操作は valid であり、マス (YH×W , XH×W )
を除いた全てのマスを偶数にできます。時間計算量は O(HW ) になります。

6


