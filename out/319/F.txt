
		公式
		
			
				F - Fighter Takahashi 解説
			
			by MMNMM
			
		
		
		
		
			次の事実が成り立ちます。


倒せる敵がいた場合、即座に倒してよい。


ただし、ここでの倒せる敵とは「訪れたことのある頂点のみを使って到達でき、\(s _ i\) が現在の高橋くんの強さ以下である頂点にいる敵」を指します。

これは、その敵を後で倒した上ですべての敵を倒すような行動が存在するなら、その敵を倒す順番だけ前倒しにした行動が成立するためです。

よって、すべての敵を倒すことができるなら、次の形式ですべての敵を倒すことができます。


倒せる敵がいるなら、その敵を倒す。
倒せる敵がいないなら、適切な薬を飲む。


次のような DP を考えます。


\(\operatorname{dp}[S]\coloneqq\) これまでに飲んだ薬の集合が \(S\) であるときの高橋くんの強さとしてありえる最大値


上の考察から、各 \(i\in S\) ごとに \(\operatorname{dp}[S\setminus\lbrace i\rbrace]\) の状態から薬 \(i\) を飲んで敵を倒せるだけ倒すことをシミュレーションすればよいです。

適切な \(O(N\log N)\) 時間の前処理のもとで、\(1\) 回のシミュレーションには \(O(N)\) 時間かかり、遷移は薬の本数を \(P\) として \(O(2^PP)\) 回なので、全体で \(O(N(2^PP+\log N))\) 時間となります。

実装例は以下のようになります。



		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
