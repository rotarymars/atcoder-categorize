
		公式
		
			
				D - ABC Puzzle 解説
			
			by physics0523
			
		
		
		
		
			実は、「 各行 / 各列 に A, B, C がちょうど
1 個ずつ含まれる 」を満たすグリッドは \(N=5\) の場合でも \(66240\) 個しか存在しません。
なので、様々な方針の枝刈り全探索でこの問題に正解することができます。この解説ではその一例を示します。

以下、 \(N=5\) であったとして説明します。
まず、行の制約のみに着目します。このとき、以下の \(2\) つの条件を守ることになります。


全ての行は ABC.. の並べ替えである
上から \(i\) 行目の最も左にある . 以外の文字は \(R_i\) である


各行についてこれを満たすものは \(20\) 通りしかありません。 ( \((5 \times 4 \times 3 )/ 3 = 20\) )
これを \(5\) 行分試すことを考えます (合計 \(20^5\) 通り)
上の行から順に決定していくことを考えます。このとき、以下の条件に違反してはなりません。


各列は A, B, C を高々 \(1\) つずつ含む。
左から \(j\) 列目の最も上にある . 以外の文字は \(C_j\) である


これに違反したことが発覚した時点で、そこで探索を打ち切って構いません。
そうして \(N\) 行全てが決まった場合、最後に以下をチェックします。


各行は A, B, C を丁度 \(1\) つ含む。


この条件も満たしていれば、そのグリッドは問題文中の条件を全て満たしています。

この解法中で演算を行う回数は高々 \(20^5 \times 5^2 = 8 \times 10^7 \times \) ( 小さな定数倍 ) 回程度と見積もれますが、実際は非常に高速に動作します。

実装例 (C++):



		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
