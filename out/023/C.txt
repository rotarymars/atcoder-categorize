
問題概要
• R 行 C 列のマス目があり、そのうち 𝑁 マスには飴が 1 個ずつありま
す。
• 高橋君はあるマスを起点として、同一の行にあるすべての飴と、同
一の列にあるすべての飴を獲得します。
• ちょうど 𝐾 個の飴を獲得するような起点マスの総数を求めよ。
• 1 ≦ 𝑅 ≦ 100,000
• 1 ≦ 𝐶 ≦ 100,000
• 1 ≦ 𝐾 ≦ 𝑁 ≦ 100,000

部分点解法 (30点)
• すべてのマスについて、そのマスに高橋君が移動した場合に何個の
飴を獲得するのかを計算します。
• 全体の計算量はO(𝑅𝐶 𝑅 + 𝐶 + 𝑁) になります。

満点解法 (30+70点)
• 最初に、元の問題と似た別の問題について考えます。
• 問題：基本設定は一緒。違うのは、高橋君がいるマスに飴があった
場合は、1 個分 (C 問題元の設定) ではなく 2 個分としてカウントしま
す。
• この問題の場合、高橋君がマス (x,y) に移動したなら、高橋君が獲
得する飴の個数が (第 x 行にある飴の総数) + (第 y 列にある飴の総
数) と等しくなります。

満点解法 (30+70点)
• 変形した問題を解くために、最初に各行、各列について飴が何個あ
るのかを計算します。

行

列
1

2

0

0

2

O

1
2

2

O

O
O

O

満点解法 (30+70点)
• 変形した問題を解くために、最初に各行、各列について飴が何個あ
るのかを計算します。
• 次に、飴が X 個ある行(列)が Y 個ある、という情報を行ごと、列ごと
にまとめます。

行

飴の個数

0

1

2

3

行の個数

0

1

2

0

O

飴の個数

0

1

2

3

O

列の個数

2

1

2

0

列
1

2

0

0

2

O

1
2

2

O
O

満点解法 (30+70点)
• すると、(行から i 個の飴)×(列から K-i 個の飴) という組み合わせを
i=0,1,…,K について計算して合計することで変形した問題を解くことが
できます。

行

飴の個数

0

1

2

3

行の個数

0

1

2

0

O

飴の個数

0

1

2

3

O

列の個数

2

1

2

0

列
1

2

0

0

2

O

1
2

2

O
O

満点解法 (30+70点)
• 最後に元の問題を、先ほど計算した値 (変形した問題の解) から増
減させることで答えを求めていきます。
• 起点となるマスに飴がない場合は両方の問題において K 個か否か
は変化しません。
• 一方で起点となるマスに飴がある場合はカウントがずれます。
・そのようなマスで (行の飴の個数) + (列の飴の個数) = K なら、
余計にカウントしていることになります。
・一方で和が K+1 ならカウントから除外していたことになります。

満点解法 (30+70点)
• まとめると、以下の手順になります。
・変形した問題で、和が K 個となるマス数を求める。
・起点に飴があり、和が K 個となるマス数だけ引く。
・起点に飴があり、和が K+1 個となるマス数だけ足す。
• 計算量は O(𝑅 + 𝐶 + 𝑁) となります。

