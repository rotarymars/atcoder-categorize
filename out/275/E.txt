
		公式
		
			
				E - Sugoroku 4 解説
			
			by nok0
			
		
		
		
		
			\(\mathrm{dp}[i][j]\) を、ルーレットを \(i\) 回回したときにマス \(j\) にいる確率と定義した動的計画法で解くことが出来ます。

遷移時に \(\text{mod } 998244353\) 上での \(\frac{1}{M}\) を計算する必要がありますが、低速な言語だと毎回これを計算していると間に合わないため、前計算しておく必要があります。

前計算を行った場合、動的計画法の状態数が \(\mathrm{O}(NK)\) 、各状態の遷移回数が \(\mathrm{O}(M)\) なので計算量は \(\mathrm{O}(NMK+ \log \mathrm{mod})\) (ここで \(\mathrm{mod}=998244353\)) です。

実装例(c++):



		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
