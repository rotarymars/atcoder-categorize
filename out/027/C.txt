
問題概要
• A と B が二人ゲームで勝負する。
• 自然数 𝑁 が与えられる。𝑥 = 1 に初期化する。
• A → B → A → … の順に次の操作を行う。
 𝑥 を 2𝑥 または 2𝑥 + 1 に置き換える。

• 𝑥 > 𝑁 にした人が負け。
• どちらかが勝つか求めよ。
• 1 ≤ 𝑁 ≤ 1018

• A の操作を赤、B の操作を青で表すと、図のように 𝑥 が変化する。

1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• 例えば 𝑁 = 5 のとき、OK の整数と NG の整数はこのように分離され
る。
1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• 境界線をまたぐ操作だけに注目すると、A の操作は左に、B の操作
は右に偏っている。
1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• 境界線をまたぐと負けてしまうので、A はできるだけ右に、B はできる
だけ左に行きたがることが分かる。
1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• これを実際にシミュレートすると B が負けると判定できる。

1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• 別の例として 𝑁 = 10 のとき、OK の整数と NG の整数はこのように
分離される。
1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• 境界線をまたぐ操作だけに注目すると、A の操作は右に、B の操作
は左に偏っている。
1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• 境界線をまたぐと負けてしまうので、A はできるだけ左に、B はできる
だけ右に行きたがることが分かる。
1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

• これを実際にシミュレートすると B が負けると判定できる。

1

3

2

4

8

5

9

10

6

11

12

7

13

14

15

解法
• 𝑁 の深さの偶奇に応じて、A と B の戦略が決まる。
• A と B の戦略を実際にシミュレートして、どちらかが勝つか判定する。

• 𝑁 の深さは次のようにして 𝑂(𝑙𝑜𝑔𝑁) 時間で計算できる。
int depth = 0;
for (long long n = N; n > 0; n /= 2)
depth++;

