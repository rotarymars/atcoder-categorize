この問題は以下の問題と等価です。

深さ N の完全二分木を考える。
葉に集合 S の要素を 1 つずつ書く。また、葉以外の頂点について、子に書かれた数の最大値を
ボトムアップに書いていく。
葉以外の任意の頂点について、子に書かれる数が相違なるように葉への要素の割当を決めること
ができるか。

S の大きい要素から (同じ数はまとめて) 葉への割当を決めていくことを考えます。
また、要素を割り当てた葉から根までのパス上の頂点を毎回黒く塗るものとします。
ある同じ数を 2 つの葉に割り当てるとき、2 つの葉を結ぶパス上に黒く塗られた頂点がまだなけれ
ば、2 つの葉の LCA で条件が満たされなくなるので不適です。見方を変えると、これは黒い頂点を
取り除いて木を分割したとき、同じ連結成分の葉に割り当ててしまうことと等価です。逆にこのよう
な葉のペアがなければ、その割当は条件を満たしています。
この事実を考えると、連結成分をできるだけ多くしておきたいので、頂点数の多い連結成分の葉か
ら貪欲に養素を割り当てていくアプローチが有効です。このとき最後まで上のような事態が起こらな
ければ答えは可能、起これば不可能です。
