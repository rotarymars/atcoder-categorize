
N − K + 1 個の連続する長さ K の部分列の和を for ループで K 個の値
を足すことで計算しようとすると，最悪 O(N 2 ) かかり (K = N/2 の時
を考えてみよう)，これは N ≤ 103 のときは問題ないが，満点を取ろうと
すると実行時間制限に間に合わないので，高速化する必要がある．

1

一つの方法としては， Si = a1 + a2 + ... + ai となる Si を計算してお
くものがある．これは， Si+1 = Si + ai+1 という式に従って合計 O(N )
で求めることができ，i 番目の要素から j 番目の和は Sj − Si−1 に等しい
ので，一つの連続する範囲について和を O(1) で計算することができる．
他にも，それぞれの要素がいくつの「長さ K の連続する部分列」に含
まれるかを計算し，それらに各 ai を掛けて足すことで答えを求めるとい
うものもあるが，これは場合分けが若干難しくなる．

4

