N × M のマス目のうち K マス選ぶ時のマンハッタン距離の和を求めよという問題です。式は明らかに X
と Y について独立なので、X の差の絶対値の和と Y の差の絶対値の和をそれぞれ求めることにします。
以下では X の差について考えます。ある 2 マスの組み合わせを固定したとき、これら以外から K − 2 マ
ス選ぶ場合全てに 1 度ずつこれらの差が寄与するので、この組を固定して考えると

(N ×M −2)
K−2

通りあります。

さらに、X が同じ場合は差が 0 なので、X が異なると仮定すると、X の差の絶対値が d となるように 2 マ
ス選ぶ方法は (N − d) × M 2 通りあります。これを全ての d に対して足し合わせると X についての答えが
求まります。Y についても N と M を入れ替えると同様に解くことができ、時間計算量としては二項係数を
求めるパートがボトルネックとなり O(N M ) でこの問題が解けました。

1

