
		公式
		
			
				E - Shiritori 解説
			
			by  blackyuki
			
		
		
		
		
			hint
実はこの問題はグラフの問題ととらえることが可能です。
それぞれの単語を、最初の \(3\) 文字を表す頂点から最後の \(3\) 文字を表す頂点へ張った有向辺として考えてみましょう。

解説
まずそれぞれの単語を、最初の \(3\) 文字を表す頂点から最後の \(3\) 文字を表す頂点へ張った有向辺として考えます。すると、頂点数 \(52^3\)、 辺数 \(N\) の有向グラフが得られます。

ここで、問題を以下のように言い換えます。


有向グラフが与えられ、駒がいずれかの頂点に置かれている。
高橋君と青木君は交互に、駒が置かれている頂点から出ている有向辺を一つ選んでその先の頂点へ駒を移動させる。
操作ができなくなった方が負ける。
全ての頂点に対して、その頂点に駒が置かれている状態からゲームを始めたときの勝敗を判定せよ。


この問題は、後退解析と呼ばれるアルゴリズムを用いることで解くことができます。まず、勝ちの頂点と負けの頂点と引き分けの頂点を定義しましょう。


一本も有向辺が出ていない頂点は負けの頂点である。
有向辺が全て勝ちの頂点に出ているような頂点も負けの頂点である。
負けの頂点に出ている有向辺が1つでも存在するような頂点は勝ちの頂点である。
上の3つをいずれも満たさない頂点は全て引き分けの頂点である。


勝ち負けが確定した頂点が増えるごとに、その頂点に向かう辺が存在するすべての頂点に対して勝ち負けが確定しているかを判定していきます。毎回愚直に判定していると \(Θ(N^2)\) かかってしまいますが、\(\mathrm{queue}\) などを用いて実装することで \(O(N)\) で解けます。

実装例 (C++)





		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
