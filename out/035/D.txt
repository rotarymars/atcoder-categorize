
問題概要

• N 頂点、M 本の重みつき有向辺からなる有向グラフが
与えられる
• 頂点 i に 1 分間滞在すると所持金が Ai 円増える
• 時刻 0 に頂点 1 から出発し、 T 分後に頂点 1 に戻る
• 所持金を最大化せよ

考察

• 滞在する必要がある頂点は 1 つと考えてよい

– 複数の頂点に滞在することにより、所持金の最大値がより
大きくなるということはありえない

• この問題は、「ある頂点 i に出来るかぎり早く到着し、
出来るかぎり滞在してから、頂点 1 に出来るかぎり
早く帰る」という問題だと分かった

考察

• 滞在する必要がある頂点は 1 つと考えてよい

– 複数の頂点に滞在することにより、所持金の最大値がより
大きくなるということはありえない

• この問題は、「ある頂点 i に出来るかぎり早く到着し、
出来るかぎり滞在してから、頂点 1 に出来るかぎり
早く帰る」という問題だと分かった
• これは最短経路問題と呼ばれる有名問題

部分点(50点)

• 以下の 2 種類の最短距離を全て求めよう！
1. 頂点 1 から、頂点 i への最短距離
2. 頂点 i から、頂点 1 への最短距離

• ワーシャルフロイド法を使うと O(N3)
• ダイクストラ法を使うと O(NMlogN)

満点(100点) 考察

• 部分点と同様、以下の 2 種類の最短距離を求めたい
1. 頂点 1 から、頂点 i への最短距離
2. 頂点 i から、頂点 1 への最短距離

• 種類 1 はダイクストラ法により高速に求められる
• 種類 2 で全ての頂点から調べては間に合わない

満点(100点) 考察

• 部分点と同様、以下の 2 種類の最短距離を求めたい
1. 頂点 1 から、頂点 i への最短距離
2. 頂点 i から、頂点 1 への最短距離

• 種類 1 はダイクストラ法により高速に求められる
• 種類 2 で全ての頂点から調べては間に合わない
• 頂点 1 から辺を逆向きに辿ることを考える

頂点6に滞在するのが最適解のとき
➡は最適解の経路を示す

5

6

4

7

8

1

2

9
3

行く方向

5
6

4

7

8

1

2

9
3

帰る方向

5
6

4

7

8

1

2

9
3

辺の向きをひっくり返す
5

6

4

7

8

1

2

9
3

二つの単一始点最短経路問題！
5

6

7
8

1
2

3

5

4

6

7
9

8

1
2

3

4

9

考察

• 結局、頂点 i から頂点 1 への最短距離というのは

• 頂点 1 から辺を逆向きに辿ったときの頂点 i への最短距離

と言い換えられる

• 最短距離を求めるのは行きと帰りの 2 回だけで十分

解法

• 各頂点について、頂点 1 からの最短距離を辺の向きが
そのままの場合と、辺の向きを逆転した場合について
求める
• ここから各頂点に滞在可能な最大の時間を求めて、
所持金の最大値を全探索する
• 計算量はO((N + M)logN)

注意

• 答えは 32 ビット整数に収まらない場合があります
– T = 109，A1 = 105 など


