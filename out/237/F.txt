
		公式
		
			
				F - |LIS| = 3 解説
			
			by sugarrr
			
		
		
		
		
			

\(dp[i][a_1][a_2][a_3]  :=\) 長さが \(i\) で、長さ \(j\) の部分増加列の最後尾として考えられる最小値が \(a_j\) であるような数列がいくつあるか


とすると、\(dp\) の状態数が \(O(NM^3)\) で、遷移が (愚直にやっても) \(O(M)\) なので、問題全体を \(O(NM^4)\) で解くことができます。

\(dp\) の初期値や遷移が分からなければ下の実装例を参考にしてください。



		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
