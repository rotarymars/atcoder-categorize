
		公式
		
			
				E - Last Train 解説
			
			by MMNMM
			
		
		
		
		
			時間を逆方向に見ることにして、駅 \(B _ i\) を時刻 \(-t-c _ i\) に出発して駅 \(A _ i\) に時刻 \(-t\) に到着する電車があるような形にします。
すると、解くべき問題は次のようになります。


駅 \(N\) に十分早く（たとえば時刻 \(-2\times10 ^ {18}\) など）いるとする。駅 \(S\) に到着することができる最小の時刻 \(-f(S)\) を求めよ（ただし、駅 \(S\) に到着することができないとき \(f(S)=-\infty\) とする）。


この問題は、それぞれの情報のうち「時刻 \(-f(S)\) 以降に駅 \(B _ i\) を出発する電車のうち最初に出発するもの」だけを見ることで解けます（同じ情報の中で遅く出るほうの列車に乗っても得をしません）。

よって、Dijkstra 法のように「これまでに見ていない駅のうち、もっとも早い時刻に到着できるもの」を順に探索することで解くことができます。

実装例は以下のようになります。
この実装例では時間を順方向に戻して「もっとも遅く出発してよい駅」から探索していることに注意してください。



		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
