
		公式
		
			
				E - Pac-Takahashi  解説
			
			by yuto1115
			
		
		解説
		
		
			お菓子マスの個数を \(N\) とします。

移動の途中に訪れるお菓子マスの集合を \(S\) としたとき、\(2^N\) 通り全ての \(S\) について、「\(S\) に含まれるお菓子マスを全て訪れた上で最終的にゴールマスにいるために必要な最小の移動回数」を求めることを考えます。これはお菓子マスを頂点とした巡回セールスマン問題の一種として捉えられます。よって、任意のお菓子マスのペアに関して「一方のお菓子マスから他方のお菓子マスに行くのに必要な最小の移動回数」が分かっていれば、bit DP によって \(O(2^NN^2)\) で求めることができます。bit DP による巡回セールスマン問題の解法を知らない方は、ABC180-E の解説等をご参照ください。

残された課題は、任意のお菓子マスのペアに関して「一方のお菓子マスから他方のお菓子マスに行くのに必要な最小の移動回数」を求めることです。これは、各お菓子マスについてそのお菓子マスを始点としたグリッド上の BFS を行うことで、\(O(NHW)\) で求めることができます。

よって、本問題を \(O(NHW + 2^NN^2)\) で解くことができました。

実装例 (C++) :



		
		
			
				投稿日時:
				
				
			
				
				最終更新:
				
				
			
			
		
	
